# 小目标检测

## 检测性能差的原因和解决措施

* 数据集中只有较少的图像中包含了小尺度目标，也就是说目标类型样本数量不均衡
* 小目标面积小，在图像中的位置分布受限，在位置上的泛化能力较差。在实际测试图像中，小目标很有可能出现在训练集中未出现过的位置

* 提高小目标数据的采样率
* 将小目标在同一副图像中复制粘贴多次，即增加图像中该类小目标的数量，粘贴过程中要避免覆盖掉已经存在的目标，这个过程还可以保证小目标所处的Context（上下文）是合适的。  

* 增加输入图像的精度；借助低层分辨率较大的Feature Map；增加不同Scale的Anchor或者借助GAN来弥补小尺度目标与大尺度目标之间的性能差异  

在确定Anchor Box为Positive时有两个标准：
* 所有与任意一个Ground Truth Box的IoU大于某一阈值
* 如果没有Anchor与某一GT box的IoU大于这一阈值，则将IoU最大的那个Anchor设为Positive  
对于小尺度的目标，其实Anchor与GT Box的IoU大于阈值可能比较难，因为这个目标在Feature Map上占的面积较小，甚至都有可能不存在了都，所以第二点是有必要的；另一方面也反映出了对于大尺度的目标，有可能存在多个Anchor Box与同一个GT Box的IoU大于阈值，这也进一步加剧了训练样本中不同尺度样本训练目标数量的不平衡(模型会偏向于大尺度目标)。  

## 复制粘贴小目标

### 策略

* 一次只复制粘贴其中一个小尺度目标多次，位置随机
* 选择多个小尺度目标，依次将这些小目标粘贴到任意位置上
* 在任意位置上把所有小尺度目标一起粘贴多次

### 注意项

* 新粘贴目标不能覆盖已经存在的目标
* 平滑新粘贴目标与原始图像相接的边缘处（Gaussian Blur）
 
`副作用`  
模型会过拟合于Copy-Pasted后的小尺度目标，而不是原始数据中存在的小尺度样本。作者认为这是由于粘贴过程中引入的Artifacts引起的，比如小尺度目标与粘贴位置的背景的亮度差异让模型很容易发现这些粘贴产生的目标等。最好的结果是引入概率，保证原始存在的小尺度目标的数量与新粘贴的小尺度目标的数量之间的比率为2:1。

## 参考链接
https://zhuanlan.zhihu.com/p/64635490
